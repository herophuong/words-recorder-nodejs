<!doctype html>
<html lang="en" ng-app="trvnApp">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TRVN Recorder</title>

    <link rel="stylesheet" href="css/bootstrap.min.css" />
    <script type="text/javascript" src="js/jquery-2.1.3.min.js"></script>
    <script type="text/javascript" src="js/bootstrap.min.js"></script>
    <script type="text/javascript" src="js/angular.min.js"></script>
    <script type="text/javascript" src="js/angular-cookies.min.js"></script>
    <script type="text/javascript" src="js/ng-infinite-scroll.min.js"></script>
    <script type="text/javascript" src="js/controllers.js"></script>
    <style type="text/css">
        .checkbox-group {margin-top: 6px;}
        .checkbox-group label {margin-right: 10px;}
        .checkbox-group label input {float: left;}
        .jumbotron h2 {margin-top: 0px}
    </style>
</head>
<body style="padding-top: 60px" ng-controller="WordCtrl">
<div class="container">
    <header>
        <nav class="navbar navbar-default navbar-fixed-top">
            <div class="container">
                <!-- Brand and toggle get grouped for better mobile display -->
                <div class="navbar-header">
                  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                  </button>
                  <a class="navbar-brand" href="#">TRVN Recorder</a>
                </div>

                <!-- Collect the nav links, forms, and other content for toggling -->
                <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                    <form class="navbar-form navbar-right" role="login" ng-if="!logged_in">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Tên người thu" ng-model="recorder">
                        </div>
                        <button type="submit" class="btn btn-default" ng-click="logIn(recorder)">Đăng nhập</button>
                    </form>
                    <ul class="nav navbar-nav navbar-right" ng-if="logged_in">
                        <li class="dropdown">
                            <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">{{recorder}} <span class="caret"></span></a>
                            <ul class="dropdown-menu" role="menu">
                                <li><a href="#" ng-click="logOut()">Đăng xuất</a></li>
                            </ul>
                        </li>
                    </ul>
                </div><!-- /.navbar-collapse -->
            </div><!-- /.container-fluid -->
        </nav>
    </header>
    <div class="page-header">
        <h1>Công cụ thu âm <small>Sử dụng cho <a target="_blank" href="https://github.com/herophuong/vietnamese-words">cơ sở dữ liệu từ đơn tiếng việt <span class="glyphicon glyphicon-new-window"></span></a></small></h1>
    </div>
    <div class="row" ng-if="logged_in">
        <div class="col-md-3 form-horizontal">
            <div class="text-center"><strong>Tuỳ chọn thu</strong></div>
            <div class="form-group" style="margin-top: 16px;">
                <label for="record-length" class="control-label col-md-7">Thời gian thu (ms)</label>
                <div class="col-md-5">
                    <input id="record-length" type="number" min="700" max="3000" step="100" ng-model="option.recordLength" class="form-control" />
                </div>
            </div>
            <div class="form-group">
                <label for="record-length" class="control-label col-md-7">Thời gian chờ(ms)</label>
                <div class="col-md-5">
                    <input id="waiting-time" type="number" min="0" max="2000" step="100" ng-model="option.waitingTime" class="form-control" />
                </div>
            </div>
        </div>
        <form class="col-md-9" style="border-left: 1px dashed #babdb6">
            <div class="form-group col-md-4">
                <label for="filter-name">Tên từ</label>
                <input id="filter-name" type="text" ng-model="filter.name" class="form-control" style="margin-top: 10px" />
            </div>
            <div class="form-group col-md-4">
                <label>Thanh điệu</label>
                <div class="checkbox-group">
                    <label>
                        <input type="checkbox" ng-model="filter.diacritic.unmarked" />
                        Ngang
                    </label>
                    <label>
                        <input type="checkbox" ng-model="filter.diacritic.acute" />
                        Sắc
                    </label>
                    <label>
                        <input type="checkbox" ng-model="filter.diacritic.grave" />
                        Huyền
                    </label>
                    <label>
                        <input type="checkbox" ng-model="filter.diacritic.hook" />
                        Hỏi
                    </label>
                    <label>
                        <input type="checkbox" ng-model="filter.diacritic.tilde" />
                        Ngã
                    </label>
                    <label>
                        <input type="checkbox" ng-model="filter.diacritic.dot" />
                        Nặng
                    </label>
                </div>
            </div>
            <div class="form-group col-md-4">
                <label>Trạng thái</label>
                <div class="checkbox-group">
                    <label>
                        <input type="checkbox" ng-model="filter['status']['recorded']" />
                        Đã thu
                    </label>
                    <label>
                        <input type="checkbox" ng-model="filter['status']['unrecorded']" />
                        Chưa thu
                    </label>
                </div>
            </div>
            <div class="clearfix"></div>
            <div class="form-group text-right">
                <button class="btn btn-primary" ng-click="updateQuery()"><span class="glyphicon glyphicon-filter"></span> Lọc từ</button>
            </div>
        </form>
    </div>
    <table id="words-table" class="table" ng-if="logged_in && words.length > 0" infinite-scroll="showMore()" infinite-scroll-distance="3">
        <thead>
            <tr>
                <th width="10%">#</th>
                <th width="20%">Từ đơn</th>
                <th width="20%">Trạng thái (Đã thu {{totalRecorded()}}/{{words.length}})</th>
                <th width="20%">Hành động</th>
            </tr>
        </thead>
        <tbody>
            <tr ng-repeat="word in words | filter:query | limitTo:totalDisplayed">
                <td>{{$index + 1}}</td>
                <td>{{word.name}}</td>
                <td>
                    <span class="label label-default" ng-if="!word.uploading && !word.recording && !word.recorded">
                        Chưa thu
                    </span>
                    <span class="label label-default" ng-if="word.waiting">
                        Hãy chờ {{word.waitingLeft}}ms...
                    </span>
                    <span class="label label-warning" ng-if="word.recording">
                        Đang thu {{(word.progress * 100).toFixed(0)}}%
                    </span>
                    <span class="label label-info" ng-if="word.uploading">
                        Đang tải lên
                    </span>
                    <span class="label label-success" ng-if="word.recorded && !word.waiting && !word.recording && !word.uploading">
                        Đã thu
                    </span>
                <td>
                    <button class="btn btn-sm btn-primary" ng-disabled="word.recording || word.uploading || !canRecord()" ng-click="record(word)">
                        <span class="glyphicon glyphicon-record"></span> Thu âm
                    </button>
                    <button class="btn btn-sm btn-success" ng-if="word.recorded" ng-click="play(word)">
                        <span class="glyphicon glyphicon-play-circle"></span> Nghe lại
                    </button>
                </td>
            </tr>
        </tbody>
    </table>
    <div class="progress" ng-if="logged_in && words.length == 0">
      <div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="45" aria-valuemin="0" aria-valuemax="100" style="width: 100%">
        Đang tải danh sách từ
      </div>
    </div>
    <div class="jumbotron" ng-if="!logged_in">
        <h2>Welcome!</h2>
        <div>Hãy đăng nhập với tên người dùng đã được cấp của bạn để bắt đầu thu âm.</div>
    </div>
</div>
</body>
</html>
